<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>tabla rowspan descargar</title>
		<style>
			table {
				width: 100%;
			}
			table,
			th,
			td {
				border: 1px solid black;
			}
		</style>
	</head>
	<body>
		<table>
			<tr>
				<th>Empreses</th>
				<th>Num.comanda</th>
				<th>Peça</th>
				<th>Quantitat</th>
				<th>Preu/Unitat</th>
			</tr>
			<tr>
				<td>Muntatges Juarez</td>
				<td>2159854</td>
				<td>Tub Alum. Gris 08054</td>
				<td>100000</td>
				<td>0.94</td>
			</tr>

			<tr>
				<td>Gestos C.Tarragona</td>
				<td>2159853</td>
				<td>Llosa Niquel 45872</td>
				<td>130000</td>
				<td>428.00</td>
			</tr>
			<tr>
				<td>Serrallers fortes S.A</td>
				<td>2159852</td>
				<td>Clau Dor. 356-a-401</td>
				<td>3100000</td>
				<td>0.13</td>
			</tr>
			<tr>
				<th colspan="4">Total</th>
				<th>56.137.000€</th>
			</tr>
		</table>
		<script>
			function downloadCSV(csv, filename) {
				var csvFile;
				var downloadLink;

				// CSV file
				csvFile = new Blob([csv], { type: "text/csv" });

				// Download link
				downloadLink = document.createElement("a");

				// File name
				downloadLink.download = filename;

				// Create a link to the file
				downloadLink.href = window.URL.createObjectURL(csvFile);

				// Hide download link
				downloadLink.style.display = "none";

				// Add the link to DOM
				document.body.appendChild(downloadLink);

				// Click download link
				downloadLink.click();
			}
			function exportTableToCSV(filename) {
				var csv = [];
				var rows = document.querySelectorAll("table tr");

				for (var i = 0; i < rows.length; i++) {
					var row = [],
						cols = rows[i].querySelectorAll("td, th");

					for (var j = 0; j < cols.length; j++) row.push(cols[j].innerText);

					csv.push(row.join(","));
				}

				// Download CSV file
				downloadCSV(csv.join("n"), filename);
			}
		</script>
		<button onclick="exportTableToCSV('members.csv')">
			Export HTML Table To CSV File
		</button>
	</body>
</html>
